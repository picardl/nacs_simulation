function V = NaCsXPES(r,deriv)

if nargin<2
    deriv = 0;
end

wavenum2hartree = 4.55634011e-6;
bohr2angstrom = 0.529177210903;
r = r*bohr2angstrom;

r1 = 2.8435;
r2 = 10.20;

A = -1.21078258e4;
B = 2.78126476e5;

a = [-4954.2371, 0.898622630664361211 , 0.151732217891396431e5,...
    0.109102058285656531e5, -0.245830537231665448e4,...
    -0.160823217089854061e5, -0.870501233606598180e4,...
    0.218804990209799216e5, -0.300253857509134803e6,...
    -0.786934963816004456e6, 0.339616569903816981e7,...
    0.735840978670415096e7, -0.263747841089096293e8,...
    -0.445851022516661808e8, 0.135133668337616146e9,...
    0.176262771092477173e9, -0.475687819616745651e9,...
    -0.447488331948895991e9, 0.121600043788157034e10,...
    0.746075686887681842e9, -0.229173358027149439e10,...
    -0.870893701850213766e9, 0.309544152674965858e10 ,...
    0.819954477849331141e9, -0.280675451799400091e10,...
    -0.696373131358783245e9, 0.151653591696465230e10,...
    0.444558275107226551e9, -0.366990899674986184e9,...
    -0.135243476249383062e9];
b = -0.4000;
Rm = 3.85062906;

C6 = 1.555214e7;
C8 = 4.967239e8;
C10 = 1.971387e10;
Aex = 2.549087e4;
gamma = 5.12271;
beta = 2.17237;

switch deriv
    case 0
        U1 =@(r) A + B./r.^3;
        U2 =@(r) sum(cell2mat(arrayfun(@(j) a(j)*((r-Rm)./(r+b*Rm)).^(j-1),reshape(1:numel(a),1,1,1,numel(a)),'un',0)),4);
        U3 =@(r) -C6./r.^6 - C8./r.^8 - C10./r.^10 - Aex*(r.^gamma).*exp(-beta*r);
    case 1
        U1 =@(r) -(3*B)./r.^4;
        U2 =@(r) sum(cell2mat(arrayfun(@(j) ...
            (Rm*a(j)*(-(Rm - r)./(r + Rm*b)).^(j - 2)*(b + 1)*(j - 1))./(r + Rm*b).^2,...
            reshape(1:numel(a),1,1,1,numel(a)),'un',0)),4);
        U3 =@(r) (6*C6)./r.^7 + (8*C8)./r.^9 + (10*C10)./r.^11 - Aex*gamma*(r.^(gamma - 1)).*exp(-beta*r) + Aex*beta*(r.^gamma).*exp(-beta*r);
    case 2
        U1 =@(r) (12*B)./r.^5;
        U2 =@(r) sum(cell2mat(arrayfun(@(j) ...
            (Rm*a(j)*(-(Rm - r)./(r + Rm*b)).^j*(b + 1)*(j - 1).*(2*r + 2*Rm*b - Rm*j - Rm*b*j))./((Rm - r).^3.*(r + Rm*b)),...
            reshape(1:numel(a),1,1,1,numel(a)),'un',0)),4);
        U3 =@(r) 2*Aex*beta*gamma*(r.^(gamma - 1)).*exp(-beta*r) - (72*C8)./r.^10 - (110*C10)./r.^12 - Aex*beta^2*(r.^gamma).*exp(-beta*r) - Aex*gamma*(r.^(gamma - 2)).*exp(-beta*r)*(gamma - 1) - (42*C6)./r.^8;
end

V = 0*r;
V(r<=r1) = U1(r(r<=r1));
V(r<r2 & r>r1) = U2(r((r<r2) & (r>r1)));
V(r>=r2) = U3(r(r>=r2));

V = V*wavenum2hartree;

end