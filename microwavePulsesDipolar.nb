(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59426,       1557]
NotebookOptionsPosition[     55554,       1485]
NotebookOutlinePosition[     55947,       1501]
CellTagsIndexPosition[     55904,       1498]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Microwave Pulses", "Title",
 CellChangeTimes->{{3.892073406215225*^9, 3.8920734192085867`*^9}, {
  3.8922016243163347`*^9, 
  3.892201644678665*^9}},ExpressionUUID->"ae970c43-9a49-4008-addc-\
280fa995a392"],

Cell["\<\
Gabriel Patenotte
Ni Lab\
\>", "Subtitle",
 CellChangeTimes->{{3.8920734265672073`*^9, 
  3.892073439595353*^9}},ExpressionUUID->"f7902428-191a-498b-9afd-\
805c6367544b"],

Cell[CellGroupData[{

Cell["Versions", "Subsection",
 CellChangeTimes->{{3.8920734450747023`*^9, 
  3.8920734465941353`*^9}},ExpressionUUID->"3cc1b051-5ffd-4632-9bac-\
74758a242c49"],

Cell["\<\
v05042023: Made this notebook based off of my singleQubitPulses.nb notebook.\
\>", "Text",
 CellChangeTimes->{{3.892073448916267*^9, 3.89207349265757*^9}, {
  3.892201649133757*^9, 
  3.892201673303823*^9}},ExpressionUUID->"607344ac-530d-4768-bcec-\
d52ce5c1e175"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup", "Subsection",
 CellChangeTimes->{{3.892067233843733*^9, 
  3.892067252122869*^9}},ExpressionUUID->"6ff37683-a46e-453e-8d7e-\
e2f89b61032c"],

Cell["\<\
Choosing default plot options, turning off warnings, and picking a color \
scheme.\
\>", "Text",
 CellChangeTimes->{{3.892073510673943*^9, 
  3.892073536487207*^9}},ExpressionUUID->"74cb151e-d18a-4eed-87a0-\
1ff675955dad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/gabrielpatenotte/Documents/Research/Ni Group/Mathematica\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"Plot", ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "20"}]}], "}"}]}], ",", 
     RowBox[{"TicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "10"}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"ListPlot", ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "20"}]}], "}"}]}], ",", 
     RowBox[{"TicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "10"}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"Off", "[", 
    RowBox[{"ClebschGordan", "::", "tri"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"Off", "[", 
    RowBox[{"ClebschGordan", "::", "phy"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"ClebschGordan", "::", "tri"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"ClebschGordan", "::", "phy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"RGBColor", "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<#408EC6\>\"", ",", "\"\<#7A2048\>\"", ",", "\"\<#1E2761\>\"", ",", 
      "\"\<#89ABE3FF\>\"", ",", "\"\<#EA738DFF\>\"", ",", "\"\<#8BB9B9\>\""}],
      "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8920672137241993`*^9, 3.892067224781764*^9}, {
  3.892202359819615*^9, 3.8922023609717484`*^9}, {3.892499567381312*^9, 
  3.892499568333045*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"be3acaba-4759-400d-b87c-ff8a883ffc5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pulses", "Subsection",
 CellChangeTimes->{{3.892202833970921*^9, 
  3.89220283484182*^9}},ExpressionUUID->"bc1af4f3-00f2-40d0-9400-\
596880bf0dc5"],

Cell["\<\
A wait time is defined as {\[OpenCurlyDoubleQuote]w\[CloseCurlyDoubleQuote],\
\[Tau]}, where \[Tau] is the wait time.
A pulse is defined as {\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote],\
\[Theta], v}, where \[Theta] is the angle of rotation, and v is the axis of \
rotation. The Rabi frequency \[CapitalOmega] and detuning \[CapitalDelta] are \
assumed to be the same for all pulses, and defined elsewhere.\
\>", "Text",
 CellChangeTimes->{{3.8922028474067183`*^9, 3.8922029625964947`*^9}, {
  3.892205184755952*^9, 3.892205219440875*^9}, {3.892210904943172*^9, 
  3.892210929800054*^9}},ExpressionUUID->"31f370cb-8f9e-42d8-b81a-\
845e9f050ff0"],

Cell[CellGroupData[{

Cell["Axes", "Subsubsection",
 CellChangeTimes->{{3.892203034966132*^9, 
  3.8922030391326513`*^9}},ExpressionUUID->"787a3b34-e640-4d4c-9719-\
5a72d1071ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"axes", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<x\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\"\<-x\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\"\<y\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\"\<-y\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
     RowBox[{"\"\<z\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"\"\<-z\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892203041275901*^9, 3.8922031019865837`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"f57562f4-a382-4977-ade6-f24d5a09084d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"\"\<z\>\"", "/.", "axes"}]}], "]"}], ".", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"\"\<y\>\"", "/.", "axes"}]}], "]"}], ".", 
     RowBox[{"(", GridBox[{
        {"0"},
        {"0"},
        {"1"}
       }], ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892203139871529*^9, 3.892203294036724*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"ea522b2e-24de-4322-b19e-3347cfaf8243"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pulses", "Subsubsection",
 CellChangeTimes->{{3.892202968742942*^9, 3.892202972158679*^9}, 
   3.892203313867217*^9},ExpressionUUID->"1fde8644-5d4b-4b71-a275-\
5d017007bf2e"],

Cell["\<\
Pulse names start with lowercase p. Eta (\[Eta]) is the pulse time error. \
Assuming all pulses have the same Rabi frequency.\
\>", "Text",
 CellChangeTimes->{{3.892203323595455*^9, 3.8922033288312473`*^9}, {
  3.8922034630210323`*^9, 
  3.8922034893399353`*^9}},ExpressionUUID->"d309635c-eccc-4f98-bd8c-\
58b354a68b31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pPhaseRamsey", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", 
       RowBox[{"n", "[", 
        RowBox[{
         FractionBox["\[Pi]", "2"], ",", "\[Phi]"}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pRamsey", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<-y\>\""}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pPhaseSpinEchoY", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", 
       RowBox[{"n", "[", 
        RowBox[{
         FractionBox["\[Pi]", "2"], ",", "\[Phi]"}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pPhaseSpinEchoX", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", 
       RowBox[{"n", "[", 
        RowBox[{
         FractionBox["\[Pi]", "2"], ",", "\[Phi]"}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pSpinEchoY", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<-y\>\""}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pSpinEchoX", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<-y\>\""}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pXY8X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", 
       RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", 
       RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", 
       RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", 
       RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", 
       RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", 
       RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", 
       RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<p\>\"", ",", 
       RowBox[{
        FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<-x\>\""}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pPhaseXY8X", "=", 
   RowBox[{"pXY8X", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", 
        RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", 
        RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", 
        RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", 
        RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", 
        RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", 
        RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<y\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", 
        RowBox[{"2", "\[Tau]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{"\[Pi]", " ", "\[Eta]"}], ",", "\"\<x\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<w\>\"", ",", "\[Tau]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "\[Eta]"}], ",", 
        RowBox[{"n", "[", 
         RowBox[{
          FractionBox["\[Pi]", "2"], ",", "\[Phi]"}], "]"}]}], "}"}]}], 
     "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8922053442412663`*^9, 3.892205388146459*^9}, {
   3.892205441091547*^9, 3.8922054412305317`*^9}, 3.892205533601778*^9, {
   3.892210934698043*^9, 3.892210974134918*^9}, 3.8922149164152803`*^9, {
   3.892216109083921*^9, 3.8922161236954193`*^9}, {3.892216254927907*^9, 
   3.892216441484825*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"83d89134-ca7c-4664-b574-c8031aa2cc7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pulse properties", "Subsubsection",
 CellChangeTimes->{{3.8922037433023252`*^9, 
  3.892203746629816*^9}},ExpressionUUID->"69e69e26-ab54-4087-aced-\
5d222d258f73"],

Cell["\<\
A block is a block of time that is either spent as a pulse \
\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote] or as a wait \
\[OpenCurlyDoubleQuote]w\[CloseCurlyDoubleQuote]. 

blockDuration calculates the duration of each block.
blockStarts calculates the absolute start time of each block.
blockEnds calculates the absolute end time of each block.
blockTimes calculates the absolute start and end time of each block.\
\>", "Text",
 CellChangeTimes->{{3.892203898721731*^9, 3.892203925812106*^9}, {
  3.892203962390152*^9, 
  3.8922040544912*^9}},ExpressionUUID->"0da20dfe-d3a9-4e19-818a-a42207d5b995"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"blockDuration", "[", "pulse_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"block", "=", 
        RowBox[{"pulse", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<p\>\"", ",", "1"}], "}"}], ",", 
          RowBox[{"block", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        FractionBox[
         RowBox[{"block", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[CapitalOmega]"], ",", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<w\>\"", ",", "0"}], "}"}], ",", 
          RowBox[{"block", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"block", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "pulse", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blockStarts", "[", "pulse_", "]"}], ":=", 
  RowBox[{
   RowBox[{"blockEnds", "[", "pulse", "]"}], "-", 
   RowBox[{"blockDuration", "[", "pulse", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blockEnds", "[", "pulse_", "]"}], ":=", 
  RowBox[{"Accumulate", "[", 
   RowBox[{"blockDuration", "[", "pulse", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blockTimes", "[", "pulse_", "]"}], ":=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"blockStarts", "[", "pulse", "]"}], ",", 
     RowBox[{"blockEnds", "[", "pulse", "]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pulseEnd", "[", "pulse_", "]"}], ":=", 
  RowBox[{
   RowBox[{"blockEnds", "[", "pulse", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"-", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.892203981943368*^9, 3.8922039820911016`*^9}, {
   3.892204018760741*^9, 3.8922040397627077`*^9}, 3.8922052914567633`*^9, {
   3.892205397766438*^9, 3.8922054140646887`*^9}, {3.892205484489415*^9, 
   3.8922054994818783`*^9}, {3.892210986891829*^9, 3.892210992267096*^9}, {
   3.892852416313307*^9, 3.892852428686874*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"0be3e961-88fe-43fc-87a0-a465c5a6da0a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["States and operators", "Subsubsection",
 CellChangeTimes->{{3.892204088780795*^9, 
  3.892204098768173*^9}},ExpressionUUID->"74f3c21e-3393-4d13-8f54-\
0ad77d264278"],

Cell["\<\
Defining ground and excited states. Pauli matrices. Atom Hamiltonian. Pulse \
Hamiltonian.\
\>", "Text",
 CellChangeTimes->{{3.8922042026656723`*^9, 
  3.892204231056448*^9}},ExpressionUUID->"ae250bc6-bcb3-49cd-aba6-\
30fc74e0b28f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=."}], ";", 
  RowBox[{"g", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";", 
  RowBox[{"e", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"g", ",", "g"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Sigma]x", ",", "\[Sigma]y", ",", "\[Sigma]z"}], "}"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
  RowBox[{"\[Sigma]p", "=", 
   RowBox[{"\[Sigma]x", "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[Sigma]y"}]}]}], ";", 
  RowBox[{"\[Sigma]m", "=", 
   RowBox[{"\[Sigma]x", "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[Sigma]y"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "\[CapitalDelta]_", "]"}], "=", 
   RowBox[{
    FractionBox["1", "2"], "\[CapitalDelta]", " ", "\[Sigma]z"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hPulse", "[", 
    RowBox[{"\[CapitalOmega]_", ",", 
     RowBox[{"{", 
      RowBox[{"vx_", ",", "vy_", ",", "vz_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    FractionBox["1", "2"], "\[CapitalOmega]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Sigma]x", " ", "vx"}], "+", 
      RowBox[{"\[Sigma]y", " ", "vy"}], "+", 
      RowBox[{"\[Sigma]z", " ", "vz"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hDD", "=", 
   RowBox[{
    FractionBox["J", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]p", ",", "\[Sigma]m"}], "]"}], "+", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]m", ",", "\[Sigma]p"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hBlock", "[", "block_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hSingle", ",", "hDouble"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"hSingle", "[", "\[CapitalDelta]_", "]"}], "=", 
      RowBox[{
       RowBox[{"h0", "[", "\[CapitalDelta]", "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<p\>\"", ",", "1"}], "}"}], ",", 
           RowBox[{"block", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"hPulse", "[", 
          RowBox[{"\[CapitalOmega]", ",", 
           RowBox[{
            RowBox[{"block", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/.", "axes"}]}], "]"}], ",", 
         "0"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hDouble", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"hSingle", "[", "0", "]"}], ",", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], "+", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
         RowBox[{"hSingle", "[", "\[CapitalDelta]0", "]"}]}], "]"}], "+", 
       "hDD"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hs", "[", "pulse_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"hBlock", "[", 
     RowBox[{"pulse", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "pulse", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.892204107138927*^9, 3.892204107294746*^9}, {
   3.892204177046156*^9, 3.892204196151692*^9}, {3.892204242949623*^9, 
   3.892204313299246*^9}, {3.892204376427479*^9, 3.89220440228771*^9}, {
   3.892204436259078*^9, 3.8922044408636513`*^9}, {3.892204526835778*^9, 
   3.892204613961527*^9}, {3.892204698056575*^9, 3.892204757302635*^9}, {
   3.892205560846601*^9, 3.8922055629279537`*^9}, {3.8922107094134197`*^9, 
   3.8922108234983*^9}, {3.892213497772978*^9, 3.892213618736185*^9}, {
   3.8928477358878937`*^9, 3.892847866362494*^9}, {3.892847903842516*^9, 
   3.892847905670054*^9}, {3.8928479387339163`*^9, 3.8928480109815817`*^9}, {
   3.892848527739975*^9, 3.892848541179875*^9}, {3.892848669400873*^9, 
   3.892848676209371*^9}, {3.892849203325856*^9, 3.8928492110446444`*^9}, {
   3.8928517297459793`*^9, 3.892851740448616*^9}, {3.892853845413673*^9, 
   3.892853847559917*^9}, 3.8928538852143803`*^9},
 CellLabel->
  "In[503]:=",ExpressionUUID->"dd407f3b-f58e-48dd-a0fa-37ac8d2b5dd2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unitary matrices", "Subsubsection",
 CellChangeTimes->{{3.8922139935343323`*^9, 
  3.892213997575541*^9}},ExpressionUUID->"6f8f2a9d-1f7f-49fb-8956-\
b6f7cb53e58c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalOmega]", "=", 
   FractionBox["\[Pi]", 
    RowBox[{"7", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]]}], ";", 
  RowBox[{"J", "=", 
   FractionBox["\[Pi]", 
    RowBox[{"13", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}]]}], ";", 
  RowBox[{"\[Eta]", "=", "1"}], ";", 
  RowBox[{"\[CapitalDelta]0", "=", 
   RowBox[{"2", "\[Pi]", " ", "10"}]}], ";", 
  RowBox[{"\[Phi]", "=", 
   FractionBox["\[Pi]", "2"]}], ";", 
  RowBox[{"tMin", "=", "0"}], ";", 
  RowBox[{"tMax", "=", 
   RowBox[{"40", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";", 
  RowBox[{"tRes", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]]}], ";", 
  RowBox[{"pulse0", "=", "pPhaseSpinEchoX"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"us", "[", 
   RowBox[{"pulse_", ",", "\[Tau]1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BT", ",", "hams"}], "}"}], ",", 
    RowBox[{
     RowBox[{"BT", "=", 
      RowBox[{
       RowBox[{"blockTimes", "[", "pulse", "]"}], "/.", 
       RowBox[{"\[Tau]", "->", "\[Tau]1"}]}]}], ";", 
     RowBox[{"hams", "=", 
      RowBox[{"hs", "[", "pulse", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"block", "=", 
            RowBox[{"pulse", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"t0", "=", 
            RowBox[{"BT", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"tf", "=", 
            RowBox[{"BT", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"MatrixExp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"hams", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"tf", "-", "t0"}], ")"}]}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "pulse", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uEnd", "[", 
    RowBox[{"pulse_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"Dot", "@@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"us", "[", 
       RowBox[{"pulse", ",", "\[Tau]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pop", "[", 
    RowBox[{"pulse_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"gg", "\[ConjugateTranspose]"}], ".", 
        RowBox[{"uEnd", "[", 
         RowBox[{"pulse", ",", "\[Tau]"}], "]"}], ".", "gg"}], "]"}], "2"], 
     "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.892205093538128*^9, 3.892205144122488*^9}, {
   3.892213722630485*^9, 3.89221378702674*^9}, {3.8922138185567093`*^9, 
   3.892213832167233*^9}, {3.89221387197488*^9, 3.892213886930418*^9}, {
   3.8922139285148563`*^9, 3.892213954615283*^9}, {3.892216477652854*^9, 
   3.892216490454145*^9}, {3.892849911038488*^9, 3.892849913705723*^9}, {
   3.892850200706092*^9, 3.89285020381334*^9}, {3.8928511427360983`*^9, 
   3.8928511476826468`*^9}, {3.892851747220269*^9, 3.892851748074471*^9}, {
   3.892851782432181*^9, 3.89285184260413*^9}, {3.8928520017072697`*^9, 
   3.892852033321559*^9}, {3.892852089230599*^9, 3.8928521849379387`*^9}, {
   3.892852245079198*^9, 3.89285229367587*^9}, {3.89285232463974*^9, 
   3.892852371861144*^9}, {3.892852624942401*^9, 3.8928526252444344`*^9}, {
   3.892852700857628*^9, 3.892852732725861*^9}, {3.892852780337715*^9, 
   3.8928528977318363`*^9}, {3.89285293207594*^9, 3.892852963236743*^9}, {
   3.892853035046921*^9, 3.892853086782823*^9}, 3.892853618545033*^9, {
   3.892853656563689*^9, 3.8928536819772377`*^9}, 3.8928538689435673`*^9, {
   3.892853903007346*^9, 3.892853940473226*^9}, 3.892853974095228*^9, 
   3.892854038319364*^9, 3.8928540792143106`*^9, 3.8928541394544687`*^9, 
   3.892854172426187*^9, 3.892854338511416*^9, {3.892854811480885*^9, 
   3.8928548253553*^9}},
 CellLabel->
  "In[592]:=",ExpressionUUID->"c5e0a78f-6352-4c53-8812-852f3c39e6b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tTo\[Tau]", "[", "t_", "]"}], "=", 
   RowBox[{
    RowBox[{"SolveValues", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pulseEnd", "[", "pulse0", "]"}], "==", "t"}], ",", "\[Tau]"}],
      "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tab", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"pop", "[", 
      RowBox[{"pulse0", ",", 
       RowBox[{"tTo\[Tau]", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "tMin", ",", "tMax", ",", "tRes"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"l2", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"tab", ",", 
    RowBox[{"Joined", "->", "True"}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], ",", 
    RowBox[{"DataRange", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tMin", " ", 
        SuperscriptBox["10", "3"]}], ",", 
       RowBox[{"tMax", " ", 
        SuperscriptBox["10", "3"]}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8928521863529654`*^9, 3.892852212139431*^9}, {
  3.892852269926112*^9, 3.8928522729659643`*^9}, {3.892852303416504*^9, 
  3.892852379198722*^9}, {3.89285243602836*^9, 3.892852520304831*^9}, {
  3.8928525811369143`*^9, 3.892852679934389*^9}, {3.892852758651976*^9, 
  3.8928527603712273`*^9}, {3.8928528276016693`*^9, 3.8928528286044693`*^9}, {
  3.892853578138619*^9, 3.892853586949511*^9}, {3.892854333257188*^9, 
  3.892854362341254*^9}},
 CellLabel->
  "In[596]:=",ExpressionUUID->"333d2d97-136d-4618-ad4b-eb2d4a2e2462"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     StyleBox[LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQMHdz2KSmWcbQfhfbB/s8D0a5h1rj1U2uHFXBtf
o4xee0Ywl8PhU6P2nq8VC6DyAg5HneryOlnXQvkiDn3ahY1TkrZB1Us43K5j
qK/Yvh/Kl3Fw+jtJIl77KFS9gkOoyoJ/lhynoXwlh2sZ08MV1lyA8lUcJrw6
8v7T/8tQvprDwdoDHeGF16HmaTgERFVOfvTxFlRey2HyVb3DdsX3oPI6Dm2n
goS3fX4AlddzcLj4xaxmwSMo38DBdlncrumWT6B8Q4dZ/SYXFHc+hfKNHObo
NHBul3wO5Rs7xPts6W8OewHlmzhw7Td66J39Eso3dXjY5TWlKOQVlG/msGKf
yK7ffK+h7jF3mCG1qalvBoxv4fDHSHN/6fvXUPWWDumpUafnC72B8q0c+BWu
+c5jhPGtHcSzLMWW7YHpt3EwvPHDvN8Fxrd1uJdfE3R1Fsx+O4fj5/tOTz8I
c5+9Q8WcwzNn7oa538FBWnSdjEMP1H8NDg6LRWWyJ5g/g8o7OnAXfy3VOgQN
nwZHByuX34mOho+h8k4Ok1+t757Q9RAq7+Twy0uqd+aK+1B5Z4dLetuUlbXu
QOWdHfbeyImfsvwGVN7FQSUnt01X/6o9ANwVvBE=
       "]],
      FontFamily->"Arial",
      FontSize->20]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  BaseStyle->{FontFamily -> "Arial", FontSize -> 20},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->500,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 40.}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic},
  TicksStyle->Directive[
    GrayLevel[0], 10]]], "Output",
 CellChangeTimes->{{3.8928522033116083`*^9, 3.892852214417922*^9}, {
   3.892852255129394*^9, 3.892852274408451*^9}, {3.89285231203124*^9, 
   3.892852348519238*^9}, {3.892852443986806*^9, 3.892852470688438*^9}, 
   3.892852598052669*^9, 3.892852659468747*^9, {3.89285269113511*^9, 
   3.892852743795072*^9}, {3.892852775455324*^9, 3.892852903899704*^9}, {
   3.892852937380913*^9, 3.892852968692252*^9}, {3.8928530413761787`*^9, 
   3.892853092069908*^9}, 3.892853542108467*^9, 3.892853592717853*^9, 
   3.892853624077157*^9, {3.892853661048764*^9, 3.892853701250392*^9}, {
   3.892853899373316*^9, 3.892853931750071*^9}, {3.892853970258313*^9, 
   3.892853998558504*^9}, 3.8928540541588573`*^9, 3.892854103044538*^9, 
   3.892854163227734*^9, 3.892854197644093*^9, {3.8928543564128923`*^9, 
   3.892854366779632*^9}, {3.892854821547991*^9, 3.892854837693754*^9}},
 CellLabel->
  "Out[598]=",ExpressionUUID->"6bf71562-1cba-4256-b3be-636ea7034c67"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase scan", "Subsection",
 CellChangeTimes->{{3.892848717330687*^9, 
  3.8928487185763693`*^9}},ExpressionUUID->"740ab5ff-e931-49b0-8b8b-\
b03ede4449d3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]s", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
           RowBox[{"0", " ", 
            SuperscriptBox["10", "3"]}], ",", 
           SuperscriptBox["10", "3"]}], " ", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tab", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"\[CapitalDelta]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "\[CapitalDelta]s", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}], ",", 
         FractionBox["\[Pi]", "16"]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"tab", ",", 
      RowBox[{"Joined", "->", "True"}]}], "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8922168445577917`*^9, 3.892216924050254*^9}, {
   3.892217182578436*^9, 3.8922172022739487`*^9}, {3.89221730166749*^9, 
   3.892217361683619*^9}, {3.892217547209799*^9, 3.892217569999024*^9}, {
   3.8922176123488693`*^9, 3.892217784773822*^9}, {3.89222091921459*^9, 
   3.892220920264007*^9}, {3.892499595957521*^9, 3.8924996078954887`*^9}, {
   3.892725452597118*^9, 3.89272545874835*^9}, {3.892725506411702*^9, 
   3.89272550780081*^9}, {3.892725805752509*^9, 3.892725809945449*^9}, 
   3.892726177138163*^9, 
   3.892726589483914*^9},ExpressionUUID->"9ecf2cdd-4a33-466e-bd99-\
a9ae49a28d18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sequence", "=", "pPhaseRamsey"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scansPerPoint", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tWait", "=", 
   RowBox[{"1", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tPi", "=", 
   RowBox[{"3", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]std", "=", 
   RowBox[{".1", " ", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]Seq", "=", 
   RowBox[{
    RowBox[{"SolveValues", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"sequence", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<w\>\""}], "&"}]}], 
          "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "==", "tWait"}], 
      ",", "\[Tau]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[Phi]1_", ",", "\[CapitalDelta]1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"pop", "[", "sequence", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalOmega]", "->", 
       FractionBox["\[Pi]", "tPi"]}], ",", 
      RowBox[{"\[Eta]", "->", "1"}], ",", 
      RowBox[{"\[CapitalDelta]", "->", "\[CapitalDelta]1"}], ",", 
      RowBox[{"\[Phi]", "->", "\[Phi]1"}], ",", 
      RowBox[{"\[Tau]", "->", "\[Tau]Seq"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.892729158688504*^9, 3.892729307363184*^9}, {
  3.892729344597637*^9, 3.89272960555298*^9}},
 CellLabel->
  "In[652]:=",ExpressionUUID->"3d193fad-5644-4db0-9b46-750ee8583902"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tab", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[Phi]", ",", 
          RowBox[{"2", "\[Pi]", " ", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{"NormalDistribution", "[", 
             RowBox[{
              RowBox[{"0", " ", 
               SuperscriptBox["10", "3"]}], ",", "\[CapitalDelta]std"}], " ", 
             "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "scansPerPoint"}], "}"}]}], "]"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}], ",", 
       FractionBox["\[Pi]", "16"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"tab", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "tWait"}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Phi]\>\"", ",", "\"\<Population\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "->", 
    RowBox[{"StringForm", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(t\), \(wait\)]\) = ``, \
\!\(\*SubscriptBox[\(t\), \(\[Pi]\)]\) = ``, \\n\!\(\*SubscriptBox[\(\
\[CapitalDelta]\), \(std\)]\) = ``, contrast: ``\>\"", ",", 
      RowBox[{
       RowBox[{"tWait", "//", "N"}], "//", "ScientificForm"}], ",", " ", 
      RowBox[{
       RowBox[{"tPi", "//", "N"}], "//", "ScientificForm"}], ",", 
      RowBox[{
       RowBox[{"\[CapitalDelta]std", "//", "N"}], "//", "ScientificForm"}], 
      ",", 
      RowBox[{"ScientificForm", "[", 
       RowBox[{
        RowBox[{"Max", "[", "tab", "]"}], "-", 
        RowBox[{"Min", "[", "tab", "]"}]}], "]"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.892725545969323*^9, 3.892725571138472*^9}, {
   3.89272596243296*^9, 3.8927259915497713`*^9}, {3.8927260489738293`*^9, 
   3.8927261290462008`*^9}, {3.892726170481838*^9, 3.892726170568437*^9}, {
   3.89272620137103*^9, 3.892726268700695*^9}, {3.892726472720133*^9, 
   3.8927264959633493`*^9}, {3.8927265552808247`*^9, 
   3.8927267779829483`*^9}, {3.892726825692441*^9, 3.892726825858724*^9}, {
   3.892726892568377*^9, 3.8927268958168707`*^9}, {3.892727163012821*^9, 
   3.8927271632414227`*^9}, 3.892727341900003*^9, {3.892727551404869*^9, 
   3.89272755902322*^9}, {3.892727634344736*^9, 3.892727635801057*^9}, {
   3.892728126012909*^9, 3.89272826322609*^9}, {3.892728469974826*^9, 
   3.8927286310699673`*^9}, {3.8927292718232117`*^9, 3.892729285470475*^9}, {
   3.892729320229013*^9, 3.892729338882804*^9}},
 CellLabel->
  "In[659]:=",ExpressionUUID->"7257d46c-31b0-4196-8409-7fb7344e33b4"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    StyleBox[PointBox[CompressedData["
1:eJxTTMoPSmViYGBQBGIQDQObE+NzuZ7vs5fQdQn5rXjS3vJrYfZZkZ1Q/k37
B7E2a0oYtttfUjSur7n5yH7Hxd9fT3OcgMq/tGea8mrH2ZBT9nEWoZpVWe/t
46rFk51eXoaq/2S//r9KtaD1NfvS5btf7v771f79BKXF4WuvQfX/tI8zYZgQ
x//IfvemM/us3P7YP3YSPrY+4gHUvP/26o0mzacyn9kz3H93Msad0eHZOs2b
E16/hJrP5GCs7u0xXeal/ZKUcpM52SwO+bEb5tpGv4Tax+pw2OnZn93Kb+3d
Xv2fd7uf3WHCjnzFu2ZvofZzOiT8stxs0/3W/lV+B6f0Fi6HvV+uzoq1fAt1
D49DgFrYnphfb+17vgqURN3gdVDKdyyfd+M11H38DlzbrxmG7H5pP2Ovz3uf
OgGHNB27qS7dL6DuFXT4ob5mQ/jUx/aZDBOX5AgIOWTIiXyY5fgA6n4hh+rw
U2kz3B7bWztfjexZJOywZMrCUiPem1D/iDhozFn1xif1sj1PmyT/GhNRh+iq
mVFC3Veg/hN1uLdKwc0n7Lj9vROxR04fE3PY4b38fNKio1D/ijvs4j14P3jK
Fvv13IsqX0dIOOxxF3q8/Nt2qP8lHbTXu/gvK99uDwBemvXn
      "]],
     FontFamily->"Arial",
     FontSize->20]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  BaseStyle->{FontFamily -> "Arial", FontSize -> 20},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"Population\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"\[Phi]\"", HoldForm], TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->500,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    InterpretationBox[
    "\"\\!\\(\\*SubscriptBox[\\(t\\), \\(wait\\)]\\) = \
\\!\\(\\*FormBox[RowBox[{\\\"\\\\\\\"1.\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-3\\\\\\\"\\\"]}], \
TraditionalForm]\\), \\!\\(\\*SubscriptBox[\\(t\\), \\(\[Pi]\\)]\\) = \
\\!\\(\\*FormBox[RowBox[{\\\"\\\\\\\"3.\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-6\\\\\\\"\\\"]}], \
TraditionalForm]\\), \\n\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \
\\(std\\)]\\) = \\!\\(\\*FormBox[RowBox[{\\\"\\\\\\\"1.\\\\\\\"\\\", \\\"\
\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"2\\\\\\\"\\\"]}], \
TraditionalForm]\\), contrast: \\!\\(\\*FormBox[RowBox[{\\\"\\\\\\\"8.56423\\\
\\\\\"\\\", \\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-1\\\\\\\
\"\\\"]}], TraditionalForm]\\)\"", 
     StringForm[
     "\!\(\*SubscriptBox[\(t\), \(wait\)]\) = ``, \!\(\*SubscriptBox[\(t\), \
\(\[Pi]\)]\) = ``, \n\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(std\)]\) = ``, \
contrast: ``", 
      ScientificForm[0.001], 
      ScientificForm[3.*^-6], 
      ScientificForm[100.], 
      ScientificForm[0.8564234978840829]], Editable -> False], 
    TraditionalForm],
  PlotRange->{{0, 6.283185307179586}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic},
  TicksStyle->Directive[
    GrayLevel[0], 10]]], "Output",
 CellChangeTimes->{
  3.892726082297462*^9, 3.89272612026215*^9, {3.8927262067445087`*^9, 
   3.892726271532132*^9}, 3.892726501748811*^9, 3.892726577810186*^9, {
   3.8927267237984962`*^9, 3.8927267828355713`*^9}, 3.8927268313182163`*^9, 
   3.892726900443349*^9, 3.892727171566265*^9, 3.892727344579238*^9, {
   3.892727555739254*^9, 3.892727562356757*^9}, {3.892727639969613*^9, 
   3.89272766890274*^9}, {3.8927281302778254`*^9, 3.892728222649037*^9}, 
   3.8927282560939693`*^9, 3.8927283505167522`*^9, {3.892728475593478*^9, 
   3.892728635801696*^9}, 3.892728830586182*^9, {3.892729292328416*^9, 
   3.892729606664324*^9}},
 CellLabel->
  "Out[660]=",ExpressionUUID->"742a0788-cc0e-4eec-8592-7b1ced4d59e8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"scansPerPoint", "=", "600"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tPi", "=", 
   RowBox[{"3", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]std", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contrastF", "[", "tWait_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"sequence", "=", "pPhaseRamsey"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[Phi]1_", ",", "\[CapitalDelta]1_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"pop", "[", "sequence", "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Tau]", "->", 
          RowBox[{"(", 
           RowBox[{"\[Tau]", "/.", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"Select", "[", 
                   RowBox[{"sequence", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<w\>\""}], 
                    "&"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "==", 
                "tWait"}], ",", "\[Tau]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"\[CapitalOmega]", "->", 
          FractionBox["\[Pi]", "tPi"]}], ",", 
         RowBox[{"\[Eta]", "->", "1"}], ",", 
         RowBox[{"\[CapitalDelta]", "->", "\[CapitalDelta]1"}], ",", 
         RowBox[{"\[Phi]", "->", "\[Phi]1"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"\[Phi]", ",", 
             RowBox[{"2", "\[Pi]", " ", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{
                 RowBox[{"0", " ", 
                  SuperscriptBox["10", "3"]}], ",", "\[CapitalDelta]std"}], 
                " ", "]"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "scansPerPoint"}], "}"}]}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}], ",", 
          FractionBox["\[Pi]", "8"]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"contrast", "=", 
      RowBox[{
       RowBox[{"Max", "[", "tab", "]"}], "-", 
       RowBox[{"Min", "[", "tab", "]"}]}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.892726973758765*^9, 3.892727071002864*^9}, {
   3.892727230574778*^9, 3.892727231642242*^9}, {3.8927273820233583`*^9, 
   3.892727401141899*^9}, {3.892727547724484*^9, 3.892727570803238*^9}, {
   3.892729621532611*^9, 3.892729636901833*^9}, {3.892729670129135*^9, 
   3.892729671589631*^9}, {3.892729722375663*^9, 3.892729734874137*^9}, 
   3.8927299862766933`*^9, {3.892730021789483*^9, 3.892730045156989*^9}, {
   3.892730096470668*^9, 3.892730097725163*^9}, {3.89273018520195*^9, 
   3.892730194843465*^9}, {3.892730291372121*^9, 3.892730293044423*^9}, {
   3.892740941521757*^9, 3.892740942997427*^9}, {3.892741018352832*^9, 
   3.892741042409676*^9}, {3.892741121142458*^9, 3.892741122714779*^9}, {
   3.892741172226493*^9, 3.892741176683506*^9}, {3.892741238747518*^9, 
   3.892741241399681*^9}, {3.8927441757701387`*^9, 3.892744179894552*^9}},
 CellLabel->
  "In[801]:=",ExpressionUUID->"b40700d0-6737-426b-a996-7b40e575def3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptab", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"contrastF", "[", 
        RowBox[{"t", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", ".01", ",", "10", ",", ".25"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"ptab", ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "10"}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<time (ms)\>\"", ",", "\"\<Contrast\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "->", 
    RowBox[{"StringForm", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(t\), \(\[Pi]\)]\) = ``, \!\(\*SubscriptBox[\(\
\[CapitalDelta]\), \(std\)]\) = ``\>\"", ",", " ", 
      RowBox[{
       RowBox[{"tPi", "//", "N"}], "//", "ScientificForm"}], ",", 
      RowBox[{
       RowBox[{"\[CapitalDelta]std", "//", "N"}], "//", "ScientificForm"}]}], 
     "]"}]}], ",", 
   RowBox[{"Joined", "->", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.892727224099341*^9, 3.892727224425704*^9}, {
   3.892727255647818*^9, 3.8927272745357723`*^9}, {3.892727405720447*^9, 
   3.892727406484621*^9}, 3.892727580616798*^9, {3.892729641204629*^9, 
   3.892729644807932*^9}, 3.892729686032736*^9, {3.892729730213587*^9, 
   3.892729730546386*^9}, {3.892730061044078*^9, 3.8927300652760878`*^9}, {
   3.892730109569911*^9, 3.89273012001945*^9}, {3.8927303105675907`*^9, 
   3.89273032484093*^9}, {3.892730402331277*^9, 3.892730402607955*^9}, {
   3.892740965757972*^9, 3.892740971434289*^9}, {3.892741001582958*^9, 
   3.8927410248404627`*^9}},
 CellLabel->
  "In[805]:=",ExpressionUUID->"2d44bb7d-c082-40ae-adac-143435eedde9"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     StyleBox[LineBox[CompressedData["
1:eJxTTMoPSmViYGDQAGIQXS2yzv1hVYt9x/FXzOa/3tsvKbDlur74gr1FatSN
sIDn9kE75FpfBz6wV+PbtUFx3yUo/4V9wplpx+LVdtlrxvQf+qrxwX7HUhbe
109WQPlf7E0mP1ZYeXsDlP/D3mLyvSUvbJdB+X/sfzy+FlSxaok92HoRBocD
wh2G/A5LoXwmhwNeOy+vjV8O5bM4ZDxk2VAlvAzKZ3N48ZzhQXsuTJ7D4cbh
sydCVRZD+VwOKxYxrXzdDePzOGi0LSvNZl0H5fM5CAT8vPd69mJ7oGeBPhZw
OLF7r5SI+CooX9BB4PyrSl+WOVC+kMMFM+E/9huWQ/nCDguOFN9rO74Syhdx
SPiXk1rUBNMv6pBwh39rwyaYejEHD7bsihezFkH54g4/Jj35OMVxLZQv4XDg
mPIlibnroXxJhxUH8nYYfF4N5Us5JExS+xB6CcaXdrixr3bTkkUw+2UcOpw1
FNW3weyXdZhxpLd/8/XNUL6cQ8fTxVmKgeugfHmHBI8Zdgw26+yBkblDjlXB
YULFI28xy7UQfquCw4WmiF3d/1dC5RUdMiRtxZ7kQ9W3Kjos6HHTrrdfD5VX
cjjw5fzegq2rofJKDhxzfU2SWBdC5ZUdHnSp75tsvQIqr+zAUfgrcmvzEnsA
ZYobeg==
       "]],
      FontFamily->"Arial",
      FontSize->20]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  BaseStyle->{FontFamily -> "Arial", FontSize -> 20},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"Contrast\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"time (ms)\"", HoldForm], TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{943.7109375, Automatic},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    InterpretationBox[
    "\"\\!\\(\\*SubscriptBox[\\(t\\), \\(\[Pi]\\)]\\) = \
\\!\\(\\*FormBox[RowBox[{\\\"\\\\\\\"3.\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-6\\\\\\\"\\\"]}], \
TraditionalForm]\\), \\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \
\\(std\\)]\\) = \\!\\(\\*FormBox[RowBox[{\\\"\\\\\\\"5.\\\\\\\"\\\", \\\"\
\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"2\\\\\\\"\\\"]}], \
TraditionalForm]\\)\"", 
     StringForm[
     "\!\(\*SubscriptBox[\(t\), \(\[Pi]\)]\) = ``, \!\(\*SubscriptBox[\(\
\[CapitalDelta]\), \(std\)]\) = ``", 
      ScientificForm[3.*^-6], 
      ScientificForm[500.]], Editable -> False], TraditionalForm],
  PlotRange->{{0, 9.76}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic},
  TicksStyle->Directive[
    GrayLevel[0], 10]]], "Output",
 CellChangeTimes->{
  3.892727315289732*^9, 3.89272745179668*^9, 3.892727605809716*^9, {
   3.892729628799032*^9, 3.892729674982229*^9}, {3.892729726427187*^9, 
   3.8927297374360943`*^9}, 3.892729950362481*^9, {3.8927300281659107`*^9, 
   3.892730066185878*^9}, {3.892730099574168*^9, 3.8927301224301643`*^9}, {
   3.892730191665159*^9, 3.892730198346352*^9}, {3.892730304654838*^9, 
   3.892730327375942*^9}, {3.892730403127617*^9, 3.892730414303102*^9}, {
   3.892740951953952*^9, 3.892740975644763*^9}, {3.892741005757709*^9, 
   3.892741053156261*^9}, 3.892741144222279*^9, 3.8927412084895067`*^9, {
   3.892744171950109*^9, 3.8927441872145643`*^9}},
 CellLabel->
  "Out[806]=",ExpressionUUID->"a14a8988-4da6-47ff-977f-a8ea2a25970c"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{2560, 1309},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"101461bf-aa8d-42d5-ab38-f454ef20497d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 212, 4, 98, "Title",ExpressionUUID->"ae970c43-9a49-4008-addc-280fa995a392"],
Cell[795, 28, 180, 6, 85, "Subtitle",ExpressionUUID->"f7902428-191a-498b-9afd-805c6367544b"],
Cell[CellGroupData[{
Cell[1000, 38, 160, 3, 54, "Subsection",ExpressionUUID->"3cc1b051-5ffd-4632-9bac-74758a242c49"],
Cell[1163, 43, 274, 6, 35, "Text",ExpressionUUID->"607344ac-530d-4768-bcec-d52ce5c1e175"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1474, 54, 153, 3, 54, "Subsection",ExpressionUUID->"6ff37683-a46e-453e-8d7e-e2f89b61032c"],
Cell[1630, 59, 232, 6, 35, "Text",ExpressionUUID->"74cb151e-d18a-4eed-87a0-1ff675955dad"],
Cell[1865, 67, 2851, 77, 178, "Input",ExpressionUUID->"be3acaba-4759-400d-b87c-ff8a883ffc5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4753, 149, 153, 3, 54, "Subsection",ExpressionUUID->"bc1af4f3-00f2-40d0-9400-596880bf0dc5"],
Cell[4909, 154, 660, 11, 58, "Text",ExpressionUUID->"31f370cb-8f9e-42d8-b81a-845e9f050ff0"],
Cell[CellGroupData[{
Cell[5594, 169, 157, 3, 45, "Subsubsection",ExpressionUUID->"787a3b34-e640-4d4c-9719-5a72d1071ddf"],
Cell[5754, 174, 995, 27, 30, "Input",ExpressionUUID->"f57562f4-a382-4977-ade6-f24d5a09084d"],
Cell[6752, 203, 670, 19, 61, "Input",ExpressionUUID->"ea522b2e-24de-4322-b19e-3347cfaf8243"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7459, 227, 180, 3, 45, "Subsubsection",ExpressionUUID->"1fde8644-5d4b-4b71-a275-5d017007bf2e"],
Cell[7642, 232, 330, 7, 35, "Text",ExpressionUUID->"d309635c-eccc-4f98-bd8c-58b354a68b31"],
Cell[7975, 241, 9094, 254, 303, "Input",ExpressionUUID->"83d89134-ca7c-4664-b574-c8031aa2cc7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17106, 500, 169, 3, 45, "Subsubsection",ExpressionUUID->"69e69e26-ab54-4087-aced-5d222d258f73"],
Cell[17278, 505, 613, 12, 150, "Text",ExpressionUUID->"0da20dfe-d3a9-4e19-818a-a42207d5b995"],
Cell[17894, 519, 2412, 64, 134, "Input",ExpressionUUID->"0be3e961-88fe-43fc-87a0-a465c5a6da0a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20343, 588, 171, 3, 45, "Subsubsection",ExpressionUUID->"74f3c21e-3393-4d13-8f54-0ad77d264278"],
Cell[20517, 593, 242, 6, 35, "Text",ExpressionUUID->"ae250bc6-bcb3-49cd-aba6-30fc74e0b28f"],
Cell[20762, 601, 4782, 125, 279, "Input",ExpressionUUID->"dd407f3b-f58e-48dd-a0fa-37ac8d2b5dd2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25581, 731, 169, 3, 45, "Subsubsection",ExpressionUUID->"6f8f2a9d-1f7f-49fb-8956-b6f7cb53e58c"],
Cell[25753, 736, 4462, 114, 114, "Input",ExpressionUUID->"c5e0a78f-6352-4c53-8812-852f3c39e6b3"],
Cell[CellGroupData[{
Cell[30240, 854, 1648, 43, 75, "Input",ExpressionUUID->"333d2d97-136d-4618-ad4b-eb2d4a2e2462"],
Cell[31891, 899, 3003, 68, 345, "Output",ExpressionUUID->"6bf71562-1cba-4256-b3be-636ea7034c67"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34955, 974, 160, 3, 54, "Subsection",ExpressionUUID->"740ab5ff-e931-49b0-8b8b-b03ede4449d3"],
Cell[35118, 979, 1857, 44, 103, "Input",ExpressionUUID->"9ecf2cdd-4a33-466e-bd99-a9ae49a28d18"],
Cell[36978, 1025, 1928, 55, 173, "Input",ExpressionUUID->"3d193fad-5644-4db0-9b46-750ee8583902"],
Cell[CellGroupData[{
Cell[38931, 1084, 2965, 71, 68, "Input",ExpressionUUID->"7257d46c-31b0-4196-8409-7fb7344e33b4"],
Cell[41899, 1157, 4129, 93, 429, "Output",ExpressionUUID->"742a0788-cc0e-4eec-8592-7b1ced4d59e8"]
}, Open  ]],
Cell[46043, 1253, 3830, 90, 204, "Input",ExpressionUUID->"b40700d0-6737-426b-a996-7b40e575def3"],
Cell[CellGroupData[{
Cell[49898, 1347, 1930, 46, 55, "Input",ExpressionUUID->"2d44bb7d-c082-40ae-adac-143435eedde9"],
Cell[51831, 1395, 3683, 85, 665, "Output",ExpressionUUID->"a14a8988-4da6-47ff-977f-a8ea2a25970c"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

